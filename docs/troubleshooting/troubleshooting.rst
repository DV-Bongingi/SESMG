Troubleshooting
*************************************************
During execution of the model generator, error messages and associated error messages may occur. 


**General debugging**:

Pay attention to the correct spelling:

- Pay attention to correct upper and lower case.
- Do not use spaces in the entire spreadsheet (except for the "comment" columns).
- Make sure that every column of the used lines is filled. Columns that are not used can be filled with a "0".

Make sure that the displayed system can stay in balance. 
- It must always be possible to take off all of the supplied energy and vice versa. 
- The use of excess-sinks and shortage-sources can help to keep the system in balance.


**Your error message is not included? Help us and all users by reporting your error message - with or without a solution! You can do this either via `GitHub <https://github.com/chrklemm/SESMG>`_ (preferred) or by mail (christian.klemm@fh-muenster.de). Thank you!**


Installation
===============================

.. csv-table:: Known Errors
   :file: ../troubleshooting/troubleshooting.csv
   :widths: 30, 30, 30
   :header-rows: 1


Modeling
===============================
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Error   Message                                                                                          | Possible Error Cause                                                                                                                                                                                                                                         | Debugging                                                                                                                                                                                                                                                                                                                        |
+==========================================================================================================+==============================================================================================================================================================================================================================================================+==================================================================================================================================================================================================================================================================================================================================+
| flowsum =   source['sequences'].sum() KeyError: 'sequences'                                              | A system component was entered   incorrectly in the input file.                                                                                                                                                                                              | For all components, make sure that 1)   each column is filled correctly, and 2) the first component of a sheet is   entered in the row directly below the header row, and that there are no blank   rows between the individual components of a sheet                                                                            |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ApplicationError:   Solver (cbc) did not exit normally                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| df =   node_results['sequences'] KeyError: 'sequences'                                                   | The implemented model probably has an circuit.   For example, the excess sink of a bus could achieve higher selling prices   than buying from a shortage source. In theory, this could generate an   infinitely large profit. Such a model cannot be solved. | Make sure, there are no circuits within the   model.                                                                                                                                                                                                                                                                             |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Memory Error                                                                                             | The available memory is not sufficient to solve   the model.                                                                                                                                                                                                 | Take the following measures gradually until the   error no longer occurs: (1) Restart the used Python interpreter (2) Close   unnecessary programs on the computer (3) Make sure that python 64 bit version   is used (Python 32 bit can manage only 2 GB of memory). (4)Start the program   on a computer with a higher memory. |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| AttributeError: module   'time' has no attribute 'clock'                                                 | You are using a Python version not compatible   with oemof.                                                                                                                                                                                                  | Use Pyhton 3.7                                                                                                                                                                                                                                                                                                                   |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ValueError: operands   could not be broadcast together with shapes (8784,) (8760,)                       | The weather dataset contains the wrong number of   data points for using feedinlib.                                                                                                                                                                          | Make sure that the number of weather data points   corresponds to the time steps of the model (At hourly resolution, one year   has 8760 time steps). When simulating a leap year, it is recommended limiting   the time horizon to 8760 hours.                                                                                  |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ValueError:   pyutilib.common._exceptions.ApplicationError: Solver (cbc) did not exit   normally         | A value for the use of the investment module   (e.g., "min Investment Capacity") was not filled in.                                                                                                                                                          | Make sure, that all necessary cells of the   spreadsheet have been filled in.                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| KeyError: '__any component name__'                                                                       | Incorrectly assigned bus name for the input or   output of a component                                                                                                                                                                                       | Check that all bus references are correct. Also   check for typos.                                                                                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| TypeError: ufunc   'true_divide' not supported for the input types, and the inputs could not be   safely | The column "annual demand" was   not filled in correctly for a sink.                                                                                                                                                                                         | Make sure to use the "annual   demand" column for SLP and Richardson sinks and the "nominal   value" column for time series sinks.                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| coerced   to any supported types according to the casting rule ''safe''                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| AttributeError: 'str'   object has no attribute 'is_variable_type'                                       | The cost value for an activated excess sink or   shortage source was not correctly specified in the bus sheet                                                                                                                                                | Make sure that all excess/sortage prices consist   of real numbers. Also check for typos.                                                                                                                                                                                                                                        |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Implicitly replacing   the Component attribute equate_InvestmentFlow.in                                  | This is no user error because this error   is due to the way undirected links are implemented                                                                                                                                                                | --                                                                                                                                                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| vest[districtheat_undirected_link,districtheat_bus]_InvestmentFlow.invest[   districtheat_undirected_link,heat_bus] (type=<class   'pyomo.core.base.constraint.SimpleConstraint'>) on block Model with a new   Component (type=<class 'pyomo.core.base.constraint.AbstractSimpleConstraint'>).   This is usually indicative of a modelling error. To avoid this warning, use   block.del_component() and block.add_component().                                                                                                                                                                                                                                                                            |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                          |                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                          |                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                          |                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                          |                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                          |                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                          |                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
          
